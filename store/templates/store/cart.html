{% extends 'store/base.html' %}

{% block title %}Корзина{% endblock %}

{% block content %}
<div class="container">
    <h2 class="section-title">Ваша корзина</h2>

    {% if cart.items.all %}
        <div style="background: var(--bg-card); padding: 2rem; border-radius: 8px; border: 1px solid #333;">
            <table style="width: 100%; border-collapse: collapse; color: #fff;">
                <thead>
                    <tr style="border-bottom: 1px solid #444; text-align: left;">
                        <th style="padding: 10px;">Автомобиль</th>
                        <th style="padding: 10px;">Цена</th>
                        <th style="padding: 10px;">Кол-во</th>
                        <th style="padding: 10px;">Действие</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in cart.items.all %}
                    <tr style="border-bottom: 1px solid #333;">
                        
                        <td style="padding: 15px; width: 100px;">
                            {% if item.car.main_image %}
                                <img src="{{ item.car.main_image.url }}" alt="{{ item.car.brand }}" style="width: 80px; border-radius: 8px;">
                            {% else %}
                                <div style="width: 80px; height: 50px; background: #333; border-radius: 8px;"></div>
                            {% endif %}
                        </td>

                        <td style="padding: 15px 20px;">
                            
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; border-bottom: 1px dashed #333; padding-bottom: 5px;">
                                <div>
                                    <strong style="color: #fff; font-size: 1.1rem;">{{ item.car.brand }} {{ item.car.model }}</strong>
                                    <span style="color: #666; font-size: 0.8rem; margin-left: 10px;">(База)</span>
                                </div>
                                <div style="color: #888; font-size: 0.95rem;">
                                    {{ item.car.price }} ₽
                                </div>
                            </div>

                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div style="color: var(--neon-blue);">
                                    <span style="color: #aaa;">Комплектация:</span> {{ item.get_tuning_type_display }} 
                                    <span style="color: #666; font-size: 0.8rem;">(x{{ item.quantity }})</span>
                                </div>
                                <div style="font-weight: bold; font-size: 1.1rem; color: var(--neon-blue);">
                                    {{ item.get_total_item_price }} ₽
                                </div>
                            </div>

                        </td>

                        <td style="padding: 15px; text-align: center;">
                            x {{ item.quantity }}
                        </td>

                        <td style="padding: 15px; text-align: center;">
                            <a href="{% url 'remove_from_cart' item.id %}" style="color: #ff4444; text-decoration: none; font-size: 0.9rem;">Удалить</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <div style="margin-top: 2rem; text-align: right; padding: 2rem; background: rgba(255,255,255,0.05); border-radius: 12px;">
                <h3 style="color: #888; margin-bottom: 0.5rem; font-size: 1rem; text-transform: uppercase;">Итого к оплате:</h3>
                <h2 style="color: #fff; font-size: 2.5rem; margin: 0;">{{ cart.get_total_price }} ₽</h2>
                
                <a href="{% url 'checkout' %}" class="btn btn-primary" style="margin-top: 1.5rem; display: inline-block; padding: 15px 40px;">
                    Оформить заказ 
                </a>
            </div>
        </div>
    {% else %}
        <p style="font-size: 1.2rem; color: var(--text-muted);">Ваша корзина пуста. <a href="{% url 'catalog' %}" style="color: var(--neon-blue);">Перейти в каталог</a></p>
    {% endif %}
</div>
{% endblock %}